package com.demo.state.optimize.states;

import com.demo.state.optimize.Order;

/**
 * å·²æ”¯ä»˜çŠ¶æ€ - å…·ä½“çŠ¶æ€å®ç°
 *
 * <p>è¡¨ç¤ºç”¨æˆ·å·²å®Œæˆæ”¯ä»˜ï¼Œè®¢å•ç­‰å¾…å•†å®¶å‘è´§çš„çŠ¶æ€ã€‚
 * æ­¤çŠ¶æ€å®ç°äº† {@link OrderState} æ¥å£ï¼Œå®šä¹‰äº†åœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹çš„æ‰€æœ‰è¡Œä¸ºã€‚</p>
 *
 * <p><strong>çŠ¶æ€ç‰¹å¾ï¼š</strong></p>
 * <ul>
 *   <li>ç”¨æˆ·å·²å®Œæˆæ”¯ä»˜ï¼Œèµ„é‡‘å·²åˆ°è´¦</li>
 *   <li>ç­‰å¾…å•†å®¶å¤„ç†å‘è´§</li>
 *   <li>å¯ä»¥å–æ¶ˆè®¢å•ï¼ˆéœ€è¦é€€æ¬¾ï¼‰</li>
 *   <li>å¯ä»¥æ‰§è¡Œå‘è´§æ“ä½œ</li>
 *   <li>æ— æ³•é‡å¤æ”¯ä»˜æˆ–ç¡®è®¤æ”¶è´§</li>
 * </ul>
 *
 * <p><strong>çŠ¶æ€è½¬æ¢è§„åˆ™ï¼š</strong></p>
 * <ul>
 *   <li><strong>å‘è´§æˆåŠŸ</strong>ï¼šè½¬æ¢åˆ° {@link ShippedState}ï¼ˆå·²å‘è´§çŠ¶æ€ï¼‰</li>
 *   <li><strong>å–æ¶ˆè®¢å•</strong>ï¼šè½¬æ¢åˆ° {@link CancelledState}ï¼ˆå·²å–æ¶ˆçŠ¶æ€ï¼‰</li>
 *   <li><strong>å…¶ä»–æ“ä½œ</strong>ï¼šä¿æŒå½“å‰çŠ¶æ€ä¸å˜</li>
 * </ul>
 *
 * <p><strong>ä¸šåŠ¡è§„åˆ™ï¼š</strong></p>
 * <ul>
 *   <li>æ”¯ä»˜å®Œæˆåï¼Œè®¢å•è¿›å…¥ç­‰å¾…å‘è´§é˜¶æ®µ</li>
 *   <li>å•†å®¶å¯ä»¥å–æ¶ˆè®¢å•ï¼ˆéœ€è¦å¤„ç†é€€æ¬¾ï¼‰</li>
 *   <li>é˜²æ­¢é‡å¤æ”¯ä»˜æ“ä½œ</li>
 * </ul>
 *
 * @author è½¯ä»¶è®¾è®¡ä¸æ¶æ„è¯¾ç¨‹
 * @version 1.0
 * @since 1.0
 */
public class PaidState implements OrderState {

    /**
     * æ”¯ä»˜è®¢å•æ“ä½œ
     *
     * <p>åœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸é‡å¤æ”¯ä»˜ã€‚</p>
     *
     * <p><strong>ä¸šåŠ¡è§„åˆ™ï¼š</strong>é˜²æ­¢é‡å¤æ”¯ä»˜ï¼Œä¿æŠ¤ç”¨æˆ·èµ„é‡‘å®‰å…¨</p>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return æ”¯ä»˜æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹å§‹ç»ˆè¿”å›falseï¼‰
     */
    @Override
    public boolean pay(Order order) {
        System.out.println("âŒ æ”¯ä»˜å¤±è´¥ï¼šè®¢å• " + order.getOrderId() + " å·²ç»æ”¯ä»˜ï¼Œè¯·å‹¿é‡å¤æ”¯ä»˜");
        System.out.println("   å½“å‰é‡‘é¢ï¼š" + order.getAmount() + "å…ƒ");
        return false;
    }

    /**
     * å‘è´§æ“ä½œ
     *
     * <p>åœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹ï¼Œå•†å®¶å¯ä»¥æ‰§è¡Œå‘è´§æ“ä½œã€‚</p>
     *
     * <p><strong>æ‰§è¡Œæµç¨‹ï¼š</strong></p>
     * <ol>
     *   <li>éªŒè¯è®¢å•çŠ¶æ€å’Œåº“å­˜</li>
     *   <li>ç”Ÿæˆå‘è´§å•å·</li>
     *   <li>é€šçŸ¥ç‰©æµå…¬å¸å–è´§</li>
     *   <li>å°†è®¢å•çŠ¶æ€è½¬æ¢ä¸ºå·²å‘è´§çŠ¶æ€</li>
     * </ol>
     *
     * <p><strong>çŠ¶æ€æ¨¡å¼ä¼˜åŠ¿ï¼š</strong></p>
     * <ul>
     *   <li>å‘è´§é€»è¾‘å°è£…åœ¨PaidStateç±»ä¸­</li>
     *   <li>çŠ¶æ€è½¬æ¢æ¸…æ™°æ˜ç¡®</li>
     *   <li>é¿å…å¤æ‚çš„æ¡ä»¶åˆ¤æ–­</li>
     * </ul>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return å‘è´§æ“ä½œæ˜¯å¦æˆåŠŸ
     */
    @Override
    public boolean ship(Order order) {
        System.out.println("ğŸšš è®¢å• " + order.getOrderId() + " æ­£åœ¨å¤„ç†å‘è´§...");
        System.out.println("   æ­£åœ¨å‡†å¤‡å•†å“...");
        System.out.println("   æ­£åœ¨è”ç³»ç‰©æµ...");

        // æ‰§è¡Œå‘è´§é€»è¾‘ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨åº“å­˜ç³»ç»Ÿå’Œç‰©æµç³»ç»Ÿ

        // çŠ¶æ€è½¬æ¢ï¼šå·²æ”¯ä»˜ -> å·²å‘è´§
        order.changeState(new ShippedState());
        System.out.println("âœ… å‘è´§æˆåŠŸï¼è®¢å•çŠ¶æ€å˜æ›´ä¸ºï¼šå·²å‘è´§");

        return true;
    }

    /**
     * ç¡®è®¤æ”¶è´§æ“ä½œ
     *
     * <p>åœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸æ‰§è¡Œç¡®è®¤æ”¶è´§æ“ä½œã€‚</p>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return ç¡®è®¤æ”¶è´§æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹å§‹ç»ˆè¿”å›falseï¼‰
     */
    @Override
    public boolean confirmDelivery(Order order) {
        System.out.println("âŒ ç¡®è®¤æ”¶è´§å¤±è´¥ï¼šè®¢å• " + order.getOrderId() + " å°šæœªå‘è´§ï¼Œæ— æ³•ç¡®è®¤æ”¶è´§");
        return false;
    }

    /**
     * å–æ¶ˆè®¢å•æ“ä½œ
     *
     * <p>åœ¨å·²æ”¯ä»˜çŠ¶æ€ä¸‹ï¼Œå–æ¶ˆè®¢å•éœ€è¦å¤„ç†é€€æ¬¾ã€‚</p>
     *
     * <p><strong>æ‰§è¡Œæµç¨‹ï¼š</strong></p>
     * <ol>
     *   <li>éªŒè¯é€€æ¬¾æ¡ä»¶</li>
     *   <li>æ‰§è¡Œé€€æ¬¾å¤„ç†</li>
     *   <li>å°†è®¢å•çŠ¶æ€è½¬æ¢ä¸ºå·²å–æ¶ˆçŠ¶æ€</li>
     * </ol>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return å–æ¶ˆæ“ä½œæ˜¯å¦æˆåŠŸ
     */
    @Override
    public boolean cancel(Order order) {
        System.out.println("ğŸš« è®¢å• " + order.getOrderId() + " æ­£åœ¨å–æ¶ˆ...");
        System.out.println("   è®¢å•å·²æ”¯ä»˜ï¼Œéœ€è¦å¤„ç†é€€æ¬¾");
        System.out.println("ğŸ’¸ æ­£åœ¨å¤„ç†é€€æ¬¾ï¼š" + order.getAmount() + "å…ƒ");

        // æ‰§è¡Œé€€æ¬¾é€»è¾‘ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨æ”¯ä»˜ç³»ç»Ÿè¿›è¡Œé€€æ¬¾

        // çŠ¶æ€è½¬æ¢ï¼šå·²æ”¯ä»˜ -> å·²å–æ¶ˆ
        order.changeState(new CancelledState());
        System.out.println("âœ… é€€æ¬¾å®Œæˆï¼Œè®¢å•å·²æˆåŠŸå–æ¶ˆ");

        return true;
    }

    // ==================== çŠ¶æ€æŸ¥è¯¢æ–¹æ³• ====================

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥æ”¯ä»˜
     *
     * <p>å·²æ”¯ä»˜çŠ¶æ€ä¸‹ä¸èƒ½é‡å¤æ”¯ä»˜ã€‚</p>
     *
     * @return falseï¼ˆä¸èƒ½æ”¯ä»˜ï¼‰
     */
    @Override
    public boolean canPay() {
        return false;
    }

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘è´§
     *
     * <p>å·²æ”¯ä»˜çŠ¶æ€ä¸‹å¯ä»¥å‘è´§ã€‚</p>
     *
     * @return trueï¼ˆå¯ä»¥å‘è´§ï¼‰
     */
    @Override
    public boolean canShip() {
        return true;
    }

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥å–æ¶ˆ
     *
     * <p>å·²æ”¯ä»˜çŠ¶æ€ä¸‹å¯ä»¥å–æ¶ˆï¼ˆéœ€è¦é€€æ¬¾ï¼‰ã€‚</p>
     *
     * @return trueï¼ˆå¯ä»¥å–æ¶ˆï¼‰
     */
    @Override
    public boolean canCancel() {
        return true;
    }

    // ==================== çŠ¶æ€ä¿¡æ¯æ–¹æ³• ====================

    /**
     * è·å–çŠ¶æ€åç§°
     *
     * @return "PAID"
     */
    @Override
    public String getStateName() {
        return "PAID";
    }

    /**
     * è·å–çŠ¶æ€æè¿°
     *
     * @return "å·²æ”¯ä»˜"
     */
    @Override
    public String getStateDescription() {
        return "å·²æ”¯ä»˜";
    }

    /**
     * è·å–å¯æ‰§è¡Œæ“ä½œåˆ—è¡¨
     *
     * @return å¯æ‰§è¡Œæ“ä½œçš„å­—ç¬¦ä¸²æè¿°
     */
    @Override
    public String getAvailableActions() {
        return "å¯æ‰§è¡Œæ“ä½œï¼š\n" +
               "  âœ… å‘è´§å•†å“\n" +
               "  âœ… å–æ¶ˆè®¢å•ï¼ˆéœ€è¦é€€æ¬¾ï¼‰\n" +
               "  âŒ æ”¯ä»˜è®¢å•ï¼ˆå·²æ”¯ä»˜ï¼‰\n" +
               "  âŒ ç¡®è®¤æ”¶è´§ï¼ˆéœ€è¦å…ˆå‘è´§ï¼‰";
    }
}