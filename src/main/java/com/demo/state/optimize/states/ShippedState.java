package com.demo.state.optimize.states;

import com.demo.state.optimize.Order;

/**
 * å·²å‘è´§çŠ¶æ€ - å…·ä½“çŠ¶æ€å®ç°
 *
 * <p>è¡¨ç¤ºå•†å®¶å·²å®Œæˆå‘è´§ï¼Œå•†å“æ­£åœ¨è¿è¾“é€”ä¸­çš„çŠ¶æ€ã€‚
 * æ­¤çŠ¶æ€å®ç°äº† {@link OrderState} æ¥å£ï¼Œå®šä¹‰äº†åœ¨å·²å‘è´§çŠ¶æ€ä¸‹çš„æ‰€æœ‰è¡Œä¸ºã€‚</p>
 *
 * <p><strong>çŠ¶æ€ç‰¹å¾ï¼š</strong></p>
 * <ul>
 *   <li>å•†å“å·²å‘è´§ï¼Œæ­£åœ¨ç‰©æµè¿è¾“ä¸­</li>
 *   <li>ç­‰å¾…ç”¨æˆ·ç¡®è®¤æ”¶è´§</li>
 *   <li>å¯ä»¥æ‰§è¡Œç¡®è®¤æ”¶è´§æ“ä½œ</li>
 *   <li>é€šå¸¸ä¸å…è®¸å–æ¶ˆè®¢å•ï¼ˆç‰¹æ®Šæƒ…å†µé™¤å¤–ï¼‰</li>
 *   <li>æ— æ³•æ”¯ä»˜æˆ–é‡å¤å‘è´§</li>
 * </ul>
 *
 * <p><strong>çŠ¶æ€è½¬æ¢è§„åˆ™ï¼š</strong></p>
 * <ul>
 *   <li><strong>ç¡®è®¤æ”¶è´§</strong>ï¼šè½¬æ¢åˆ° {@link CompletedState}ï¼ˆå·²å®ŒæˆçŠ¶æ€ï¼‰</li>
 *   <li><strong>å…¶ä»–æ“ä½œ</strong>ï¼šä¿æŒå½“å‰çŠ¶æ€ä¸å˜</li>
 * </ul>
 *
 * <p><strong>ä¸šåŠ¡è§„åˆ™ï¼š</strong></p>
 * <ul>
 *   <li>å‘è´§åè®¢å•è¿›å…¥è¿è¾“é˜¶æ®µ</li>
 *   <li>ç”¨æˆ·å¯ä»¥è·Ÿè¸ªç‰©æµä¿¡æ¯</li>
 *   <li>é€šå¸¸ä¸å…è®¸å–æ¶ˆï¼ˆç‰¹æ®Šæƒ…å†µéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰</li>
 *   <li>ç¡®è®¤æ”¶è´§åè®¢å•å®Œæˆ</li>
 * </ul>
 *
 * @author è½¯ä»¶è®¾è®¡ä¸æ¶æ„è¯¾ç¨‹
 * @version 1.0
 * @since 1.0
 */
public class ShippedState implements OrderState {

    /**
     * æ”¯ä»˜è®¢å•æ“ä½œ
     *
     * <p>åœ¨å·²å‘è´§çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸æ”¯ä»˜æ“ä½œã€‚</p>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return æ”¯ä»˜æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåœ¨å·²å‘è´§çŠ¶æ€ä¸‹å§‹ç»ˆè¿”å›falseï¼‰
     */
    @Override
    public boolean pay(Order order) {
        System.out.println("âŒ æ”¯ä»˜å¤±è´¥ï¼šè®¢å• " + order.getOrderId() + " å·²å‘è´§ï¼Œæ— éœ€æ”¯ä»˜");
        return false;
    }

    /**
     * å‘è´§æ“ä½œ
     *
     * <p>åœ¨å·²å‘è´§çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸é‡å¤å‘è´§æ“ä½œã€‚</p>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return å‘è´§æ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåœ¨å·²å‘è´§çŠ¶æ€ä¸‹å§‹ç»ˆè¿”å›falseï¼‰
     */
    @Override
    public boolean ship(Order order) {
        System.out.println("âŒ å‘è´§å¤±è´¥ï¼šè®¢å• " + order.getOrderId() + " å·²ç»å‘è´§ï¼Œè¯·å‹¿é‡å¤å‘è´§");
        return false;
    }

    /**
     * ç¡®è®¤æ”¶è´§æ“ä½œ
     *
     * <p>åœ¨å·²å‘è´§çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å¯ä»¥ç¡®è®¤æ”¶è´§ï¼Œå®Œæˆè®¢å•ã€‚</p>
     *
     * <p><strong>æ‰§è¡Œæµç¨‹ï¼š</strong></p>
     * <ol>
     *   <li>éªŒè¯è®¢å•çŠ¶æ€å’Œç”¨æˆ·èº«ä»½</li>
     *   <li>ç¡®è®¤å•†å“å·²é€è¾¾</li>
     *   <li>å°†è®¢å•çŠ¶æ€è½¬æ¢ä¸ºå·²å®ŒæˆçŠ¶æ€</li>
     *   <li>è§¦å‘ç›¸å…³åç»­ä¸šåŠ¡ï¼ˆå¦‚è¯„ä»·æé†’ï¼‰</li>
     * </ol>
     *
     * <p><strong>çŠ¶æ€æ¨¡å¼ä¼˜åŠ¿ï¼š</strong></p>
     * <ul>
     *   <li>ç¡®è®¤æ”¶è´§é€»è¾‘å°è£…åœ¨ShippedStateç±»ä¸­</li>
     *   <li>çŠ¶æ€è½¬æ¢æ¸…æ™°æ˜ç¡®</li>
     *   <li>ä¸šåŠ¡é€»è¾‘é›†ä¸­ç®¡ç†</li>
     * </ul>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return ç¡®è®¤æ”¶è´§æ“ä½œæ˜¯å¦æˆåŠŸ
     */
    @Override
    public boolean confirmDelivery(Order order) {
        System.out.println("âœ… è®¢å• " + order.getOrderId() + " æ­£åœ¨ç¡®è®¤æ”¶è´§...");
        System.out.println("   æ„Ÿè°¢æ‚¨çš„è´­ä¹°ï¼å•†å“å·²é€è¾¾");
        System.out.println("   è®¢å•é‡‘é¢ï¼š" + order.getAmount() + "å…ƒ");

        // æ‰§è¡Œç¡®è®¤æ”¶è´§é€»è¾‘ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šï¼š
        // 1. æ›´æ–°ç‰©æµçŠ¶æ€
        // 2. é€šçŸ¥å•†å®¶è®¢å•å®Œæˆ
        // 3. è§¦å‘è¯„ä»·æé†’
        // 4. å¯èƒ½ç»™äºˆç§¯åˆ†å¥–åŠ±ç­‰

        // çŠ¶æ€è½¬æ¢ï¼šå·²å‘è´§ -> å·²å®Œæˆ
        order.changeState(new CompletedState());
        System.out.println("ğŸ‰ è®¢å•å®Œæˆï¼è®¢å•çŠ¶æ€å˜æ›´ä¸ºï¼šå·²å®Œæˆ");

        return true;
    }

    /**
     * å–æ¶ˆè®¢å•æ“ä½œ
     *
     * <p>åœ¨å·²å‘è´§çŠ¶æ€ä¸‹ï¼Œé€šå¸¸ä¸å…è®¸å–æ¶ˆè®¢å•ã€‚</p>
     *
     * <p><strong>ä¸šåŠ¡è§„åˆ™ï¼š</strong></p>
     * <ul>
     *   <li>å•†å“å·²åœ¨è¿è¾“é€”ä¸­ï¼Œå–æ¶ˆæˆæœ¬é«˜</li>
     *   <li>å»ºè®®ç”¨æˆ·å…ˆç¡®è®¤æ”¶è´§å†ç”³è¯·å”®å</li>
     *   <li>ç‰¹æ®Šæƒ…å†µéœ€è¦äººå·¥å¤„ç†</li>
     * </ul>
     *
     * @param order è®¢å•ä¸Šä¸‹æ–‡å¯¹è±¡
     * @return å–æ¶ˆæ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåœ¨å·²å‘è´§çŠ¶æ€ä¸‹é€šå¸¸è¿”å›falseï¼‰
     */
    @Override
    public boolean cancel(Order order) {
        System.out.println("âŒ å–æ¶ˆå¤±è´¥ï¼šè®¢å• " + order.getOrderId() + " å·²å‘è´§ï¼Œæ— æ³•ç›´æ¥å–æ¶ˆ");
        System.out.println("   å»ºè®®ï¼šç¡®è®¤æ”¶è´§åå¯ç”³è¯·å”®åå¤„ç†");
        return false;
    }

    // ==================== çŠ¶æ€æŸ¥è¯¢æ–¹æ³• ====================

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥æ”¯ä»˜
     *
     * <p>å·²å‘è´§çŠ¶æ€ä¸‹ä¸èƒ½æ”¯ä»˜ã€‚</p>
     *
     * @return falseï¼ˆä¸èƒ½æ”¯ä»˜ï¼‰
     */
    @Override
    public boolean canPay() {
        return false;
    }

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘è´§
     *
     * <p>å·²å‘è´§çŠ¶æ€ä¸‹ä¸èƒ½é‡å¤å‘è´§ã€‚</p>
     *
     * @return falseï¼ˆä¸èƒ½å‘è´§ï¼‰
     */
    @Override
    public boolean canShip() {
        return false;
    }

    /**
     * æ£€æŸ¥æ˜¯å¦å¯ä»¥å–æ¶ˆ
     *
     * <p>å·²å‘è´§çŠ¶æ€ä¸‹é€šå¸¸ä¸å…è®¸å–æ¶ˆã€‚</p>
     *
     * @return falseï¼ˆä¸èƒ½å–æ¶ˆï¼‰
     */
    @Override
    public boolean canCancel() {
        return false;
    }

    // ==================== çŠ¶æ€ä¿¡æ¯æ–¹æ³• ====================

    /**
     * è·å–çŠ¶æ€åç§°
     *
     * @return "SHIPPED"
     */
    @Override
    public String getStateName() {
        return "SHIPPED";
    }

    /**
     * è·å–çŠ¶æ€æè¿°
     *
     * @return "å·²å‘è´§"
     */
    @Override
    public String getStateDescription() {
        return "å·²å‘è´§";
    }

    /**
     * è·å–å¯æ‰§è¡Œæ“ä½œåˆ—è¡¨
     *
     * @return å¯æ‰§è¡Œæ“ä½œçš„å­—ç¬¦ä¸²æè¿°
     */
    @Override
    public String getAvailableActions() {
        return "å¯æ‰§è¡Œæ“ä½œï¼š\n" +
               "  âœ… ç¡®è®¤æ”¶è´§\n" +
               "  âŒ æ”¯ä»˜è®¢å•ï¼ˆå·²æ”¯ä»˜ï¼‰\n" +
               "  âŒ å‘è´§å•†å“ï¼ˆå·²å‘è´§ï¼‰\n" +
               "  âŒ å–æ¶ˆè®¢å•ï¼ˆå·²å‘è´§ï¼Œè¯·è”ç³»å®¢æœï¼‰";
    }
}